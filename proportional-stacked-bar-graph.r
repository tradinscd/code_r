# Proportional Stacked Bar Graph# original source: r graphics cookbook# load the ggplot2 packagelibrary(ggplot2)# load the gcookbook packagelibrary(gcookbook)# load the plyr packagelibrary(plyr)# do dataframe to dataframe apply. split up cabbage_exp by "Date" (there are three dates), and create a new variable which is percent_weightce <- ddply(cabbage_exp, "Date", transform, percent_weight = Weight / sum(Weight) * 100)# create a ggplot data object of date, percent_weight, and filled by cultivar ggplot(ce, aes(x=Date, y=percent_weight, fill=Cultivar)) +   # plot the bars that are black  geom_bar(stat="identity", colour="black") +   # reserve the legend so it matches the colors  guides(fill=guide_legend(reverse=TRUE)) +   # fill with the pastel1 color palette  scale_fill_brewer(palette="Pastel1")